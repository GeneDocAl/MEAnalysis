source('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Korb-MEA/Class/ElectrodeBurstsClass.R')

plate1_5min <- c(
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-18-24 div 25/Plate 1/Plate 1 DIV 24 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-15-24 DIV 22/Plate 1/Plate 1 DIV 22 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-14-24 DIV 21/Plate 1/Plate 1 DIV 21 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-13-24 DIV 20/Plate 1/Plate 1 DIV 20 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-11-24/Plate 1/Plate 1 DIV 18 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-10-24/Plate 1/Plate 1 DIV 17 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-9-24/Plate 1/Plate 1 DIV 16 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-8-24/Plate 1/Plate 1 DIV 15 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-7-24/Plate 1/Plate 1 DIV 14 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-6-24/Plate 1/Plate 1 DIV 13 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-5-24/Plate 1/Plate 1 DIV 12 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-4-24/Plate 1/Plate 1 DIV 11 Min 5 Bursts.csv"
)

plate1_30min <- c(
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-18-24 div 25/Plate 1/Plate 1 DIV 24 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-17-24/Plate 1/Plate 1 DIV 24 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-15-24 DIV 22/Plate 1/Plate 1 DIV 22 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-14-24 DIV 21/Plate 1/Plate 1 DIV 21 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-13-24 DIV 20/Plate 1/Plate 1 DIV 20 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-11-24/Plate 1/Plate 1 DIV 18 Min 30 Bursts.csv"
)

plate3_5min <- c(
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-18-24 div 25/Plate 3/Plate 3 DIV 24 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-17-24/Plate 3/Plate 3 DIV 24 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-15-24 DIV 22/Plate 3/Plate 3 DIV 22 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-14-24 DIV 21/Plate 3/Plate 3 DIV 21 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-13-24 DIV 20/Plate 3/Plate 3 DIV 20 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-11-24/Plate 3/Plate 3 DIV 18 Min 10 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-9-24/Plate 3/Plate 3 DIV 16 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-8-24/Plate 3/Plate 3 DIV 15 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-7-24/Plate 3/Plate 3 DIV 14 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-6-24/Plate 3/Plate 3 DIV 13 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-5-24/Plate 3/Plate 3 DIV 12 Min 5 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-4-24/Plate 3/Plate 3 DIV 11 Min 5 Bursts.csv"
)

plate3_30min <- c(
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-18-24 div 25/Plate 3/Plate 3 DIV 24 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-17-24/Plate 3/Plate 3 DIV 24 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-15-24 DIV 22/Plate 3/Plate 3 DIV 22 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-14-24 DIV 21/Plate 3/Plate 3 DIV 21 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-13-24 DIV 20/Plate 3/Plate 3 DIV 20 Min 30 Bursts.csv",
  "/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Steven_MEA/ra nxn and Sean 6-11-24/Plate 3/Plate 3 DIV 18 Min 30 Bursts.csv"
)


#Generate all the barplots

for (file in plate1_5min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'NEG Control-WT'
    samples = c('NEG Control-WT', 'NEG Control-HET')
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 5 Min/NEG v HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 10, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate1_5min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-HET'
    samples = c("ASH1L-HET", "CHD8-HET", "DNMT3A-HET", "KDM6B-HET", "KMT2C-HET", "Luciferase-HET", "MBD5-HET", "MED13L-HET", "NSD1-HET", "SETD5-HET", "TBR1-HET")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 5 Min/LUC HET v DEP HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate1_5min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-WT'
    samples = c("ASH1L-WT", "CHD8-WT", "DNMT3A-WT", "KDM6B-WT", "KMT2C-WT", "Luciferase-WT", "MBD5-WT", "MED13L-WT", "NSD1-WT", "SETD5-WT", "TBR1-WT")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 5 Min/LUC WT v DEP WT')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate1_30min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'NEG Control-WT'
    samples = c('NEG Control-WT', 'NEG Control-HET')
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 30 Min/NEG v HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 10, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate1_30min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-HET'
    samples = c("ASH1L-HET", "CHD8-HET", "DNMT3A-HET", "KDM6B-HET", "KMT2C-HET", "Luciferase-HET", "MBD5-HET", "MED13L-HET", "NSD1-HET", "SETD5-HET", "TBR1-HET")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 30 Min/LUC HET v DEP HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate1_30min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-WT'
    samples = c("ASH1L-WT", "CHD8-WT", "DNMT3A-WT", "KDM6B-WT", "KMT2C-WT", "Luciferase-WT", "MBD5-WT", "MED13L-WT", "NSD1-WT", "SETD5-WT", "TBR1-WT")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 1 Barplots 30 Min/LUC WT v DEP WT')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate3_5min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'U'
    samples = c('U', 'NEG Control-HET')
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 3 Barplots 5 Min/NEG v HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 10, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate3_5min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-HET'
    samples = c("ASH1L-HET", "CHD8-HET", "DNMT3A-HET", "KDM6B-HET", "KMT2C-HET", "Luciferase-HET", "MBD5-HET", "MED13L-HET", "NSD1-HET", "SETD5-HET", "TBR1-HET")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 3 Barplots 5 Min/LUC HET v DEP HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate3_30min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = "U"
    samples = c('U', 'NEG Control-HET')
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 3 Barplots 30 Min/NEG v HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 10, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}

for (file in plate3_30min) {
  tryCatch({
    plot = ElectrodeBursts$new(file)
    control = 'Luciferase-HET'
    samples = c("ASH1L-HET", "CHD8-HET", "DNMT3A-HET", "KDM6B-HET", "KMT2C-HET", "Luciferase-HET", "MBD5-HET", "MED13L-HET", "NSD1-HET", "SETD5-HET", "TBR1-HET")
    title = basename(file)
    title = sub("\\.csv$", "", title)

    plot = plot$create_comparison_raster_plot(control, samples, title)
    setwd('/Users/stevensu/Desktop/Korb Lab/MEA Analysis/Rili Dataset Final Results/Plate 3 Barplots 30 Min/LUC HET v DEP HET')
    ggsave(paste(title, '.pdf', sep = ""), plot = plot, width = 20, height = 30, dpi = 300)
  }, error = function(e) {
    cat("Error in file:", file, "\nMessage:", e$message, "\n")
  })
}
